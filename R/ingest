library(data.table)

# Function to read all CSV files in a folder
read_folder <- function(folder_name){
  files <- list.files(folder_name, pattern = "\\.csv$", full.names = TRUE)
  data_list <- lapply(files, function(f) {
    fread(f, colClasses = list(character = 8))  # force column 8 (Barcode_Item) as character
  })
  rbindlist(data_list, use.names = TRUE, fill = TRUE)
}


# Read each year (folders inside working directory)
supermarket_2013 <- read_folder("2013")
supermarket_2014 <- read_folder("2014")
supermarket_2015 <- read_folder("2015")


# Combine all years
supermarket_data <- rbindlist(
  list(supermarket_2013, supermarket_2014, supermarket_2015),
  use.names = TRUE, fill = TRUE
)


# Quick check
dim(supermarket_data)



# Save to CSV on your computer
fwrite(supermarket_data, "supermarket_data.csv")
